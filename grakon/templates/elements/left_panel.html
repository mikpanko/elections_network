{% load elements %}

{% if not current_location or current_location.is_region %}
    {% include "dialogs/change_location.html" %}
{% endif %}

{% include "blocks/voters.html" %}

{% include "blocks/observers.html" %}

{% include "blocks/members.html" %}

{% include "blocks/journalists.html" %}

{% include "blocks/lawyers.html" %}

{% include "blocks/prosecutors.html" %}

{% include "blocks/authorities.html" %}

<script type="text/javascript">
    // TODO: move it inside become_voter.html
    /*$("#voters_ul li").each(function(index){
        new UserListItem($(this));
    });

    $("#add_to_contacts_dialog").on("add_to_contacts_event", function(event, username){
        // TODO: explicit use of url (use global variable instead) - everywhere
        $('#voters_ul li a[href="/users/'+username+'/"]').parent().children(".ui-icon-plus").css("visibility", "hidden");
    });

    $("#report_dialog").on("report_dialog_event", function(event, username){
        $('#voters_ul li a[href="/users/'+username+'/"]').parent().children(".ui-icon-notice").css("visibility", "hidden");
    });*/
</script>

{% if user.is_authenticated %}
    {% include "dialogs/add_to_contacts.html" %}

    <script type="text/javascript">
        // Become voter
        /*$("#become_voter_dialog").on("become_voter_event", function(event, location_id){
            var user_voter_li = $('#voters_ul li a[href="{{ user.get_absolute_url }}"]').parent();
            if (location_id=={{ current_location.id }}){
                $("#become_voter .ui-button-text").text("Сменить избирательный округ");
                if (user_voter_li.length==0)
                    $("#voters_ul").append($("<li/>").append(
                        $("<a/>").attr("href", "{{ user.get_absolute_url }}").text("{{ user.username }}")
                    ));
            } else {
                $("#become_voter .ui-button-text").text("Записаться в избиратели");
                user_voter_li.remove();
            }
        });*/
    </script>
{% endif %}

{% include "dialogs/report.html" %}
